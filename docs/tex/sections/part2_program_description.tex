% Part 2: Program Description
\chapter{Program Description and Usage}
\label{ch:usage}

\section{Program Structure}

The NAP computer program consists of one main program, one function, and twelve subroutines. The program structure follows this execution flow:

\begin{enumerate}
  \item \textbf{Program MAIN:} Initiates the run by reading input data, printing the program title and abstract, and converting units. Calls geometry subroutines and performs the main time-stepping loop.
  \item \textbf{GEOM and GEOMCB:} Calculate the nozzle geometry for fixed wall and optional centerbody configurations.
  \item \textbf{ONEDIM:} Calculates the one-dimensional isentropic initial-value surface using a Newton-Raphson scheme to find Mach numbers from area ratios.
  \item \textbf{MAP:} Calculates mapping functions that transform the physical plane to a rectangular computational plane.
  \item \textbf{INTER:} Performs the interior mesh calculations using the MacCormack finite-difference scheme.
  \item \textbf{INLET, WALL:} Implement boundary conditions using second-order characteristic-based schemes.
  \item \textbf{MASFLO:} Calculates mass flow and thrust during the solution.
  \item \textbf{PLOT:} Generates film plots of solution contours and velocity vectors.
\end{enumerate}

\section{Input Data Format}

Input data are provided via Fortran NAMELIST format. The primary input namelists are:

\subsection*{NAMELIST /CNTRL/: Control Parameters}

Key parameters controlling the simulation:

\begin{description}
  \item[LMAX, MMAX] Grid dimensions ($\xi$ and $\eta$ directions)
  \item[NMAX] Maximum number of time steps
  \item[NPRINT] Print frequency (0 = final solution only, $n > 0$ = every $n$ steps)
  \item[TCONV] Convergence criterion for steady-state detection
  \item[FDT] Frequency for time-step recalculation
  \item[TSTOP] Simulation stop time
  \item[GAMMA] Specific heat ratio ($\gamma = 1.4$ for air)
  \item[RGAS] Gas constant (53.35 for air in English units)
  \item[NASM] Number of inlet stagnation point profiles (1 or $> 1$ for variable inlet conditions)
  \item[IUNIT] Unit conversion flag (0 = English, 1 = SI)
\end{description}

\subsection*{NAMELIST /GEMTRY/: Geometry Parameters}

Nozzle geometry definition:

\begin{description}
  \item[NDIM] Dimension flag (0 = 2D axisymmetric, 1 = 2D Cartesian)
  \item[NGEOM] Geometry type (1 = converging, 2 = converging-diverging, 3 = plug)
  \item[XI, XE] Inlet and exit axial coordinates
  \item[RI, RE] Inlet and exit radii
  \item[RCI, RCT, RCE] Centerbody inlet, throat, and exit radii (if centerbody present)
  \item[ANGI, ANGE] Inlet and exit half-angles (degrees)
  \item[NWPTS] Number of wall definition points
\end{description}

\subsection*{NAMELIST /BC/: Boundary Conditions}

Inlet boundary condition parameters:

\begin{description}
  \item[PT] Stagnation pressure profile (array of NASM values)
  \item[TT] Stagnation temperature profile (array of NASM values)
  \item[THETA] Inlet flow angle profile (degrees)
  \item[PE] Exit static pressure
  \item[NSTAG] Stagnation profile flag (0 = uniform, $> 0$ = radial variation)
  \item[ISUPER] Supersonic inlet flag (0 = subsonic, 1 = supersonic)
\end{description}

\section{Output Description}

The program produces output in three forms:

\subsection*{1. Printed Output}

ASCII output containing:
\begin{itemize}
  \item Program header and version information
  \item Echo of input parameters (CNTRL, GEMTRY, BC namelists)
  \item Initial geometry and one-dimensional surface calculations
  \item Iteration history with time, time-step size, and convergence measures (if requested)
  \item Final solution statistics including mass flow, momentum, and thrust
\end{itemize}

\subsection*{2. Film Plots}

Vector plots and contour plots on graphics film (if NPLOT $ \geq 0$):
\begin{itemize}
  \item Velocity vectors at each solution time
  \item Contours of Mach number, pressure, density
  \item Wall streamline positions
\end{itemize}

\subsection*{3. Punched Card Output (Optional)}

Fortran unformatted binary restart deck for continuing previous runs.

\section{Sample Calculations}

Three nozzle geometries have been analyzed and serve as test cases:

\subsection*{Case 1: Converging-Diverging Nozzle}

A 45$^{\circ}$--15$^{\circ}$ converging-diverging geometry with uniform inlet conditions at stagnation pressure $P_T = 13.78$ psia and temperature $T_T = 530$ $^{\circ}$R. Results show excellent agreement with one-dimensional theory at the throat and quasi-2D behavior in the diverging section.

\subsection*{Case 2: Converging Nozzle}

A simple 15Â° converging geometry with identical inlet conditions. Used to test subsonic inlet conditions and convergent-only nozzles.

\subsection*{Case 3: Plug Nozzle}

A complex plug nozzle configuration with variable centerbody. Comparison with experimental data of Bresnahan and Johns (Reference 18) shows good agreement in gross features including shock structure at off-design conditions.

\medskip

For detailed sample input and output listings, refer to the original NAP documentation. The program is controlled entirely via namelist input which provides flexibility for analyzing various nozzle configurations and inlet conditions.

\subsection*{Case No. 1 Input Deck (Converted from Original Fig. 7)}

\noindent\textit{Editorial conversion note:} Original Figure~7 is a compact data-deck listing. In this conversion, it is rendered as a cleaned text listing for readability and reuse.

\lstinputlisting[basicstyle=\footnotesize\ttfamily,breaklines=true,linewidth=\textwidth]{conversion/fig7/fig7_case1_data_deck.txt}

\subsection*{Case No. 1 Output (Converted from Original Fig. 8)}

\noindent\textit{Editorial conversion note:} In the original report, Figure~8 is a multi-page line-printer output block (run progression plus solution-surface table). In this conversion, it is represented as tabulated/listing content for readability and traceability.

\subsubsection*{Run Progression (from Fig. 8 pages 22--23)}

\input{tex/tables/fig8_run_progression_longtable.tex}

\subsubsection*{Solution Surface Output Listing (Original Fig. 8, pages 24--27)}

\noindent\textit{Note:} A structured OCR-normalized table is provided below with full $21\times8$ row coverage (168 rows). Because this scan region is degraded, a subset of entries required OCR interpretation of ambiguous characters; raw extraction files are retained under \texttt{docs/conversion/fig8/} for auditability.

\input{conversion/fig8/fig8_surface301_longtable.tex}

\subsection*{Case No. 2 Input Deck (Converted from Original Fig. 9)}

\noindent\textit{Editorial conversion note:} Original Figure~9 is a compact data-deck listing. In this conversion, it is rendered as a cleaned text listing for readability and reuse.

\lstinputlisting[basicstyle=\footnotesize\ttfamily,breaklines=true,linewidth=\textwidth]{conversion/fig9/fig9_case2_data_deck.txt}

\subsection*{Case No. 2 Output (Converted from Original Fig. 10)}

\noindent\textit{Editorial conversion note:} In the original report, Figure~10 is a multi-page line-printer output block (run progression, solution-surface table, and mass/thrust summary). In this conversion, it is represented as tabulated/listing content for readability and traceability.

\subsubsection*{Run Progression (from Fig. 10 continuation page)}

\input{tex/tables/fig10_run_progression_longtable.tex}

\subsubsection*{Solution Surface Output Listing (Original Fig. 10, pages 32--34)}

\noindent\textit{Note:} A structured OCR-normalized table is provided below with full $23\times7$ row coverage (161 rows). Because this scan region is degraded, a subset of entries required OCR interpretation of ambiguous characters; raw extraction files are retained under \texttt{docs/conversion/fig10/} for auditability.

\input{conversion/fig10/fig10_surface250_longtable.tex}

\subsection*{Case No. 3 Input Deck (Converted from Original Fig. 11)}

\noindent\textit{Editorial conversion note:} Original Figure~11 is a compact data-deck listing. In this conversion, it is rendered as a cleaned text listing so the namelist-style input can be copied and read directly.

\lstinputlisting[basicstyle=\footnotesize\ttfamily,breaklines=true,linewidth=\textwidth]{conversion/fig11/fig11_case3_data_deck.txt}

\subsection*{Case No. 3 Output (Converted from Original Fig. 12)}

\noindent\textit{Editorial conversion note:} In the original report, Figure~12 is a multi-page line-printer output block (input summary, run progression, and solution-surface tables). In this conversion, it is represented as tabulated/listing content for readability and traceability rather than as a graphical figure.

\subsubsection*{Run Progression (from Fig. 12 continuation page)}

\input{tex/tables/fig12_run_progression_longtable.tex}

\subsubsection*{Input Summary Listing (Original Fig. 12, first page)}

\lstinputlisting[basicstyle=\footnotesize\ttfamily,breaklines=true,linewidth=\textwidth]{conversion/fig12/fig12_p36_ascii.txt}

\subsubsection*{Solution Surface Output Listing (Original Fig. 12, pages 38--41)}

\noindent\textit{Note:} OCR on pages 40--41 can read the surface number as ``395'' in the header, but the $L$ column continues monotonically from 1 to 31 and the reported times are effectively unchanged; this block is treated as one continued solution-surface output. A structured OCR-normalized table is provided below with full $31\times6$ row coverage (186 rows). Some rows required OCR interpretation of ambiguous digits/symbols; raw extraction files are retained under \texttt{docs/conversion/fig12/} for auditability.

\input{conversion/fig12/fig12_surface345_longtable.tex}

\medskip
\noindent\textit{Note:} This chapter was reconstructed from OCR-extracted text and program code analysis. For production use, consult the original LASL technical documentation and verify input/output specifications with the actual Fortran source code listings in Appendix C.
