      SUBROUTINE GEOMCB
C
C     **************************************************************
C     THIS SUBROUTINE CALCULATES THE CENTERBODY RADIUS AND SLOPE
C     **************************************************************
C
C     OCR note:
C     Reconstructed from Appendix C listing text blocks. Some FORMAT
C     literal wording was normalized for readability in degraded regions.
C
      DIMENSION YW(81),NXNY(81)
      COMMON /AV/ IAV,CAV,NST,SMP,LSS,CTA,XMU,XLA,RKMU,QUT(81,21),QVT(81,21),QPT(81,21)
      COMMON /ONESID/ UD(4),VD(4),PD(4),ROD(4)
      COMMON /SOLUTN/ U(81,21,2),V(81,21,2),P(81,21,2),RO(81,21,2)
      COMMON /CNTRLC/ LMAX,MMAX,NMAX,NPRINT,TCONV,FDT,GAMMA,RGAS,GAM1,GAM2,
     1L1,L2,L3,M1,M2,DX,DY,DT,N,N1,N3,NASM,IVEL,ICHAR,N1D,LJET,JFLAG,
     2IERR,IUI,IUO,DXR,DYR,LD,MD,LMD1,LMD3,IB,RSTAR,RSTARS,NPLOT,G,PC,TC,
     3LC,PLOW,ROLOW
      COMMON /GCB/ NGCB,XICB,RICB,XTCB,RTCB,XECB,RECB,RCICB,RCTCB,ANGICB,
     1ANGECB,XCB(81),YCB(81),XCBI(81),YCBI(81),NXNYCB(81),NCBPTS,IINTCB,
     2IDIFCB,LECB
      COMMON /BCC/ PT(21),TT(21),THETA(21),PE,MASSE,MASSI,MASST,THRUST,
     1NSTAG
      REAL MN3,NXNY,MASSI,MASST,NXNYCB,MASSE
C
      GO TO (10,30,120,160), NGCB
C
C     CYLINDRICAL CENTERBODY CASE
C
10    IF (IUI.EQ.1) PRINT 230, XICB,RICB,XECB
      IF (IUI.EQ.2) PRINT 240, XICB,RICB,XECB
      LECB=LMAX
      DO 20 L=1,LMAX
      YCB(L)=RICB
      NXNYCB(L)=0.0
20    CONTINUE
      GO TO 200
C
C     CIRCULAR-ARC, CONICAL CENTERBODY CASE
C
30    XI=XICB
      RI=RICB
      RT=RTCB
      XE=XECB
      RCI=RCICB
      RCT=RCTCB
      ANGI=ANGICB
      ANGE=ANGECB
      RI=2.0*RT-RI
      IF (RCI.EQ.0.0.OR.RCT.EQ.0.0) GO TO 190
      ANI=ANGI*3.141593/180.0
      ANE=ANGE*3.141593/180.0
      XTAN=XI+RCI*SIN(ANI)
      RTAN=RI+RCI*(COS(ANI)-1.0)
      RT1=RT-RCT*(COS(ANI)-1.0)
      XT1=XTAN+(RTAN-RT1)/TAN(ANI)
      IF (XT1.GE.XTAN) GO TO 40
      XT1=XTAN
      RT1=RTAN
40    XT=XT1+RCT*SIN(ANI)
      XTCB=XT
      XT2=XT+RCT*SIN(ANE)
      RT2=RT+RCT*(1.0-COS(ANE))
      RE=RT2+(XE-XT2)*TAN(ANE)
      RECB=RE
      RI=2.0*RT-RI
      RE=2.0*RT-RE
      IF (IUI.EQ.1) PRINT 250, XI,RI,RT,XE,RCI,RCT,ANGI,ANGE,XT,RE
      IF (IUI.EQ.2) PRINT 260, XI,RI,RT,XE,RCI,RCT,ANGI,ANGE,XT,RE
      RI=2.0*RT-RI
      RE=2.0*RT-RE
      DO 110 L=1,LMAX
      X=XI+(L-1)*DX
      IF (X.GE.XI.AND.X.LE.XTAN) GO TO 50
      IF (X.GT.XTAN.AND.X.LE.XT1) GO TO 60
      IF (X.GT.XT1.AND.X.LE.XT) GO TO 70
      IF (X.GT.XT.AND.X.LE.XT2) GO TO 80
      IF (X.GT.XT2.AND.X.LE.XE) GO TO 90
C
50    YW(L)=RI+RCI*(COS(ASIN((X-XI)/RCI))-1.0)
      NXNY(L)=(XI-X)/(YW(L)-RI+RCI)
      GO TO 100
C
60    YW(L)=RT1+(XT1-X)*TAN(ANI)
      NXNY(L)=TAN(ANI)
      GO TO 100
C
70    YW(L)=RT+RCT*(1.0-COS(ASIN((XT-X)/RCT)))
      NXNY(L)=(XT-X)/(RCT+RT-YW(L))
      GO TO 100
C
80    YW(L)=RT+RCT*(1.0-COS(ASIN((X-XT)/RCT)))
      NXNY(L)=(XT-X)/(RCT+RT-YW(L))
      GO TO 100
C
90    YW(L)=RT2+(X-XT2)*TAN(ANE)
      NXNY(L)=-TAN(ANE)
C
100   YCB(L)=2.0*RTCB-YW(L)
      NXNYCB(L)=-NXNY(L)
      IF (YCB(L).GE.0.0) GO TO 110
      YCB(L)=0.0
      NXNYCB(L)=0.0
110   CONTINUE
      GO TO 200
C
C     GENERAL CENTERBODY CASE - INPUT CENTERBODY COORDINATES ONLY
C
120   PRINT 220
      IF (IUI.EQ.1) PRINT 270, IINTCB,IDIFCB
      IF (IUI.EQ.2) PRINT 280, IINTCB,IDIFCB
      LDUM=NCBPTS
      IF (LMAX.GT.NCBPTS) LDUM=LMAX
      IP=1
      DO 130 L=1,LMAX
      XCB(L)=XICB+DX*(L-1)
      CALL MTLUP (XCB(L),YCB(L),IINTCB,NCBPTS,NCBPTS,1,IP,XCBI,YCBI)
130   CONTINUE
      DO 150 L=1,LDUM
      IF (L.GT.LMAX) GO TO 140
      SLOPE=DIF(L,IDIFCB,LMAX,XCB,YCB)
      NXNYCB(L)=-SLOPE
      IF (YCB(L).GE.0.0) GO TO 135
      YCB(L)=0.0
      NXNYCB(L)=0.0
      SLOPE=-NXNYCB(L)
135   IF (L.LE.NCBPTS.AND.L.LE.LMAX) PRINT 310, L,XCBI(L),YCBI(L),XCB(L),YCB(L),SLOPE
      IF (L.GT.NCBPTS.AND.L.LE.LMAX) PRINT 320, L,XCB(L),YCB(L),SLOPE
140   IF (L.LE.NCBPTS.AND.L.GT.LMAX) PRINT 330, L,XCBI(L),YCBI(L)
150   CONTINUE
      GO TO 200
C
C     GENERAL CENTERBODY CASE - INPUT CENTERBODY COORDINATES AND SLOPES
C
160   PRINT 220
      IF (IUI.EQ.1) PRINT 290
      IF (IUI.EQ.2) PRINT 300
      DO 180 L=1,LMAX
      XCB(L)=XICB+DX*(L-1)
      IF (YCB(L).GE.0.0) GO TO 170
      YCB(L)=0.0
      NXNYCB(L)=0.0
170   SLOPE=-NXNYCB(L)
      PRINT 340, L,XCB(L),YCB(L),SLOPE
180   CONTINUE
      GO TO 200
C
190   PRINT 350
      IERR=1
      RETURN
C
200   IF (IUI.EQ.1) RETURN
      DO 210 L=1,LMAX
      YCB(L)=YCB(L)/2.54
210   CONTINUE
      XICB=XICB/2.54
      XECB=XECB/2.54
      DX=DX/2.54
      RETURN
C
C     FORMAT STATEMENTS
C
220   FORMAT (1H )
230   FORMAT (1H0,20X,52HA CYLINDRICAL CENTERBODY HAS BEEN SPECIFIED BY,
     1XICB=,F8.4,12H (IN), RICB=,F8.4,16H (IN), AND XECB=,F8.4,5H (IN))
240   FORMAT (1H0,20X,52HA CYLINDRICAL CENTERBODY HAS BEEN SPECIFIED BY,
     1XICB=,F8.4,12H (CM), RICB=,F8.4,16H (CM), AND XECB=,F8.4,5H (CM))
250   FORMAT (1H0,20X,62HA CIRCULAR-ARC, CONICAL CENTERBODY HAS BEEN SPECIFIED BY XICB=,F8.4,5H (IN),
     17H, RICB=,F8.4,6H (IN),/,21X,8HRTCB=,F8.4,7H (IN),,5HXECB=,F8.4,5H (IN),
     28H, RCICB=,F8.4,5H (IN),8H, RCTCB=,F8.4,5H (IN),9H, ANGICB=,F6.2,7H (DEG),
     3/,21X,11HAND ANGECB=,F6.2,8H (DEG),,29HTHE COMPUTED VALUES ARE XTCB=,F8.4,
     45H (IN),10H AND RECB=,F8.4,6H (IN),)
260   FORMAT (1H0,20X,62HA CIRCULAR-ARC, CONICAL CENTERBODY HAS BEEN SPECIFIED BY XICB=,F8.4,5H (CM),
     17H, RICB=,F8.4,6H (CM),/,21X,8HRTCB=,F8.4,7H (CM),,5HXECB=,F8.4,5H (CM),
     28H, RCICB=,F8.4,5H (CM),8H, RCTCB=,F8.4,5H (CM),9H, ANGICB=,F6.2,7H (DEG),
     3/,21X,11HAND ANGECB=,F6.2,8H (DEG),,29HTHE COMPUTED VALUES ARE XTCB=,F8.4,
     45H (CM),10H AND RECB=,F8.4,6H (CM),)
270   FORMAT (1H0,20X,76HA GENERAL CENTERBODY HAS BEEN SPECIFIED BY THE FOLLOWING PARAMETERS,
     1 IINTCB=,I1,9H, IDIFCB=,I1,/,22X,1HL,10X,8HXCBI(IN),10X,8HYCBI(IN),9X,
     27HXCB(IN),10X,7HYCB(IN),11X,5HSLOPE,/)
280   FORMAT (1H0,20X,76HA GENERAL CENTERBODY HAS BEEN SPECIFIED BY THE FOLLOWING PARAMETERS,
     1 IINTCB=,I1,9H, IDIFCB=,I1,/,22X,1HL,10X,8HXCBI(CM),10X,8HYCBI(CM),9X,
     27HXCB(CM),10X,7HYCB(CM),11X,5HSLOPE,/)
290   FORMAT (1H0,20X,68HA GENERAL CENTERBODY HAS BEEN SPECIFIED BY THE FOLLOWING PARAMETERS,
     1 //,22X,1HL,11X,7HXCB(IN),10X,7HYCB(IN),11X,5HSLOPE,/)
300   FORMAT (1H0,20X,68HA GENERAL CENTERBODY HAS BEEN SPECIFIED BY THE FOLLOWING PARAMETERS,
     1 //,22X,1HL,11X,7HXCB(CM),10X,7HYCB(CM),11X,5HSLOPE,/)
310   FORMAT (1H ,20X,I2,7X,F10.4,7X,F10.4,7X,F10.4,7X,F10.4,7X,F10.4)
320   FORMAT (1H ,20X,I2,41X,F10.4,7X,F10.4,7X,F10.4)
330   FORMAT (1H ,20X,I2,7X,F10.4,7X,F10.4)
340   FORMAT (1H ,20X,I2,7X,F10.4,7X,F10.4,7X,F10.4)
350   FORMAT (1H0,48H**** RCICB OR RCTCB WAS SPECIFIED AS ZERO ****)
      END
