
SUBROUTINE MTLUPCX,YM,N,MAX,NTABfI,VAR I,VARD)

MTL
MIL
MTL
MTL
THIS SUBROUTINE IS CALLED BY SUBROUTINE CEOM TO INTERPOLATE FOR
MTL
E8UALLY SPACED NOZZLE WALL COORDINATES FOR THE TABULAR INPUT
MTL
CASE, SUBROUTINE MTLUP WAS TAKEN FROM THE NASA-LANGLEY PROGRAM
MTL
LIBRARY. THE DATE OF THIS VERSION IS 0R-I2-69,
MTL
MTL
MTL
MTL
MODIFICATION OF LIBRARY INTERPOLATION SUBROUTINE
FTLUP
MTL
MULTIPLE TABLE LOOK-UP ON ONE INDEPENDENT VARIABLE TABLE
MTL
USES AN EXTERNAL INTERVAL POINTER (II TO START SEARCH
MTL
I LESS THAN 0 WILL CHECK MONOTONICITY
MTL
MTL
DIMENSION VARKI), VARDCMAX,)), YU), VO), YY (2)
MTL
LOGICAL EX
MTL
MTL
IF (M,EO,0) GO TO 170
MTL
IF (N.LE.l) GO TO 170
MTL
EX=,F,
MTL
IF (I,GE,0) GO TO 60
MTL
IF (N.LT,2) GO TO 60
MTL
MTL
MONOTONICITY CHECK
MTL
MTL
IF (VARI(2)-VARI(1)) 20,20,40
MTL
MTL
ERROR IN MONOTONICITY
MTL
MTL
K.LOCFCVARIO))
MTL
PRINT 190, J,K, (VARKJ), JI,N)
MTL
STOP
MTL
MTL
monotonic decreasing
MTL
MTL
DO 30 J*2,N
MTL
IF (VARI(J)-VARI(J-l)) 30,10,10
MTL
CONTINUE
MTL
GO TO 60
MTL
MTL
MONOTONIC INCREASING
MTL
MTL
DO 50 J=2,N
MTL
IF (VARI(J)-VARl(J-l)) 10,10,50
MTL
continue
MTL
MTL
INTERPOLATION
MTL
MTL
IF (I,LE,0) I=1
MTL
IF (I.GE.N) IN-1
MTL
MTL
LOCATE I INTERVAL (X( I),LE.X.LT,X(J +1))
MTL
MTL
IF ((VARI(I)-X)(VARI(I+1)-X)) 100,100,70
MTL
MTL
IN GIVES DIRECTION FOR SEARCH OF INTERVALS
MTL
MTL
IN=SIGN( | ,0, (VARI<IM)-VARI(I))*(X-VARI{I) ) )
MTL
MTL
IF X OUTSIDE ENDPOINTS, EXTRAPOLATE FROM END INTERVAL
MTL
MTL
IF ((I+IN).LE,0) GO TO 90
MTL
IF (U*IN).GE.N) 60 TO 90
MTL
I=ItIN
MTL
IF ((VARICI).X)=(VARI(IH)-X)) 100, 100,60
MTL
MTL
extrapolation
MTL
MTL
ex=,t.
MTL
IF (M.E0.2) GO TO 120
MTL
MTL
FIRST ORDER
MTL
MTL
DO 1)0 NT=1,NT A0
MTL
Y(NT)B(VARD(I,NT)*(VARI(Ifl)*X)-VARD(I=l,NT)*(VARI(I)-X))/(VARI(I*MTL
11)VARI(I))
MTL
IF (EX) I=IfIN
MTL
RETURN
MTL
MTL
MTL
SECOND ORDER
MTL

10
20
30

Ufl
50
60
70
B0
90
100
110
120
130
140
150
160
170
160
190
200
210
220
230
240
250
260
270
280
290
300
310
320
330
340
350
360
370
380
390
400
410
420
430
440
450
460
470
480
490
500
510
520
530
540
550
560
570
580
590
600
610
620
630
640
650
660
670
680
690
700
710
720
730
740
750
760
770
780
790
800
810
820
830

57

12a

130
1 40
150

160

170
180
C
190

58

IF (N,F0>2) GO TO 10
IF (I,EQ,(N.|n GO TO !=0
IF (I.EO.J) GO TO 130

HTl
HTl
MTL
MTL
PICK THIRD POINT
MTL
MTL
3K=V*RI(I+1)-V*RI(I)
MTL
IF ((SK=(X-VARI(I=!)>),LTt{SM(VARI(I2)*xn> GO TO 1=0
MTL
L=I
MTL
GO TO 150
MTL
l=I>)
MTL
VCl)*VARI(t)X
MTL
V(2)?VARI(L+1JX
MTL
V(3)=VARI(L+2)*X
MTL
DO )60 NT=I,NTAB
MTL
rY(l)(VARD(l,NT)*V(2)-VARDa*l,NTlV(l))/(VARI(ltl).JPYARia))
MTL
YY(2)=(VARD(L*I*NT)*V(3)*VARO(t + 2#NTl*V(2))/CJPYARI(LA2)'VARI(Ltl )) MTL
Y{NT)(YY(1)6V(3)YY(2)*V(1))/(VARI(L2)-VARI(L))
MTL
IF (EX) IIMN
MTL
RETURN
MTL
MTL
ZERO ORDER
MTL
MTL
DO |80 NT=1,NTAB
MTL
Y(NT)mVARD(l,NT)
MTL
RETURN
MTL
MTL
FORMAT (1H1,49H TABLE BELON OUT OF ORDER FOR MTLUP AT POSITION
=IMTL
15,/31H X TABLE IS STORED IN LOCATION > 06 // (80 5,8))
MTL
END
