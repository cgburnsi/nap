      SUBROUTINE PLOT(TITLE,T,NP)
C
C     **************************************************************
C     THIS SUBROUTINE PLOTS THE VELOCITY VECTORS AND DEPENDENT
C     VARIABLE CONTOUR PLOTS
C     **************************************************************
C
C     OCR note:
C     Reconstructed from Appendix C PDF text blocks. Contour-cell
C     intersection logic (labels 240-320) was restored from degraded
C     scan blocks with normalized fixed-form token syntax.
C
      DIMENSION CQ(81,21),CON(9),XCO(4),YCO(4),TITLE(8)
      COMMON /AV/ IAV,CAV,NST,SMP,LSS,CTA,XMU,XLA,RKMU,QUT(81,21),QVT(81,21),QPT(81,21)
      COMMON /ONESID/ UD(4),VD(4),PD(4),ROD(4)
      COMMON /SOLUTN/ U(81,21,2),V(81,21,2),P(81,21,2),RO(81,21,2)
      COMMON /CNTRLC/ LMAX,MMAX,NMAX,NPRINT,TCONV,FDT,GAMMA,RGAS,GAM1,GAM2,
     1L1,L2,L3,M1,M2,DX,DY,DT,N,N1,N3,NASM,IVEL,ICHAR,N1D,LJET,JFLAG,
     2IERR,IUI,IUO,DXR,DYR,LD,MD,LMD1,LMD3,IB,RSTAR,RSTARS,NPLOT,G,PC,TC,
     3LC,PLOW,ROLOW
      COMMON /GEMTRYC/ NGEOM,XI,RI,XT,RT,XE,RE,RCI,RCT,ANGI,ANGE,XW(81),
     1YW(81),XWI(81),YWI(81),NXNY(81),NWPTS,IINT,IDIF,LT,NDIM
      COMMON /GCB/ NGCB,XICB,RICB,XTCB,RTCB,XECB,RECB,RCICB,RCTCB,ANGICB,
     1ANGECB,XCB(81),YCB(81),XCBI(81),YCBI(81),NXNYCB(81),NCBPTS,IINTCB,
     2IDIFCB,LECB
      COMMON /BCC/ PT(21),TT(21),THETA(21),PE,MASSE,MASSI,MASST,THRUST,
     1NSTAG
      REAL MN3,NXNY,MASSI,MASST,NXNYCB,MASSE
C
C     GENERATE THE VELOCITY VECTOR PLOT
C
      ND=N3
      IF (N.EQ.0) ND=1
      CALL GETG (4HKJBN,JNM)
      XL=XI
      XR=XE
      YT=YW(1)
      YB=YCB(1)
      DO 10 L=2,LMAX
      YT=AMAX1(YT,YW(L))
      YB=AMIN1(YB,YCB(L))
10    CONTINUE

      VV=0.9*DX
      FIYB=916.0
      XD=(XR-XL)/(YT-YB)
      FIR=(1022.0-1022.0/FLOAT(L1)-1.0)/900.0
      IF (XD.LE.FIR) GO TO 20
      FIXL=0.0
      FIXR=1022.0-1022.0/FLOAT(L1)-1.0
      FIYT=916.0-FIXR/XD
      GO TO 30
20    FIXL=511.0-450.0*XD
      FIXR=511.0+450.0*XD
      FIYT=16.0
30    XCONV=(FIXR-FIXL)/(XR-XL)
      YCONV=(FIYT-FIYB)/(YT-YB)

      VMAX=0.0
      DO 40 L=1,LMAX
      DO 40 M=1,MMAX
      VMAX=AMAX1(VMAX,ABS(U(L,M,ND)),ABS(V(L,M,ND)))
40    CONTINUE
      IF (VMAX.LT.1.0E-10) GO TO 60

      DROU=VV/VMAX
      CALL ADV (1)
      DO 50 L=1,LMAX
      IX1=FIXL+(FLOAT(L-1)*DX)*XCONV
      DYL=(YW(L)-YCB(L))/FLOAT(MMAX-1)
      DO 50 M=1,MMAX
      IY1=FIYB+(YCB(L)+FLOAT(M-1)*DYL-YB)*YCONV
      IX2=FIXL+(FLOAT(L-1)*DX+U(L,M,ND)*DROU)*XCONV
      IY2=FIYB+(YCB(L)+FLOAT(M-1)*DYL-YB+V(L,M,ND)*DROU)*YCONV
      CALL DRV (IX1,IY1,IX2,IY2)
      CALL PLT (IX1,IY1,16)
50    CONTINUE
      CALL LINCNT (59)
      WRITE (7,410)
      WRITE (7,550) JNM,TITLE,NP,T
C
C     GENERATE THE CONTOUR PLOTS
C
60    I=0
70    I=I+1
      GO TO (80,100,120,140,340), I

80    DO 90 L=1,LMAX
      DO 90 M=1,MMAX
      CQ(L,M)=RO(L,M,ND)*G
90    CONTINUE
      GO TO 160

100   DO 110 L=1,LMAX
      DO 110 M=1,MMAX
      CQ(L,M)=P(L,M,ND)/PC
110   CONTINUE
      GO TO 160

120   DO 130 L=1,LMAX
      DO 130 M=1,MMAX
      CQ(L,M)=P(L,M,ND)/RO(L,M,ND)/RGAS/G-TC
130   CONTINUE
      GO TO 160

140   DO 150 L=1,LMAX
      DO 150 M=1,MMAX
      CQ(L,M)=SQRT(U(L,M,ND)**2+V(L,M,ND)**2)/(GAMMA*P(L,M,ND)/RO(L,M,ND))
150   CONTINUE

160   QMN=1.0E06
      QMX=-QMN
      DO 170 L=1,LMAX
      DO 170 M=1,MMAX
      QMN=AMIN1(CQ(L,M),QMN)
      QMX=AMAX1(CQ(L,M),QMX)
170   CONTINUE
      XX=QMX-QMN
      DQ=0.1*XX
      DO 180 K=1,9
      CON(K)=QMN+FLOAT(K)*DQ
180   CONTINUE
      K=9

      CALL ADV (1)
      CALL LINCNT (59)
      GO TO (190,200,210,220), I
190   WRITE (7,560)
      GO TO 230
200   WRITE (7,570)
      GO TO 230
210   WRITE (7,580)
      GO TO 230
220   WRITE (7,590)
230   WRITE (7,400) QMN,QMX,CON(1),CON(K),DQ
      WRITE (7,550) JNM,TITLE,NP,T
C
      DO 520 L=2,LMAX
      DY=(YW(L-1)-YCB(L-1))/FLOAT(MMAX-1)
      DY1=(YW(L)-YCB(L))/FLOAT(MMAX-1)
      DO 520 M=2,MMAX
      NN=0
      DO 520 KK=1,K
      K1=0
      K2=0
      K3=0
      K4=0
      IF (CQ(L-1,M-1).LE.CON(KK)) K1=1
      IF (CQ(L,M-1).LE.CON(KK)) K2=1
      IF (CQ(L-1,M).LE.CON(KK)) K3=1
      IF (CQ(L,M).LE.CON(KK)) K4=1
      IF (K1*K2*K3*K4.NE.0) GO TO 520
      IF (K1+K2+K3+K4.EQ.0) GO TO 520
      IF (NN.NE.0) GO TO 240
      NN=1
      XCO(1)=XI+FLOAT(L-2)*DX
      XCO(2)=XCO(1)+DX
      XCO(3)=XCO(1)
      XCO(4)=XCO(2)
      YCO(1)=YCB(L-1)+FLOAT(M-2)*DY
      YCO(2)=YCB(L)+FLOAT(M-2)*DY1
      YCO(3)=YCB(L-1)+FLOAT(M-1)*DY
      YCO(4)=YCB(L)+FLOAT(M-1)*DY1
240   LL=0
      IF (K1+K3.NE.1) GO TO 250
      IC1=1
      IC2=3
      LP1=L-1
      MP1=M-1
      LP2=L-1
      MP2=M
      ASSIGN 250 TO KR1
      GO TO 280
250   IF (K1+K2.NE.1) GO TO 260
      IC1=1
      IC2=2
      LP1=L-1
      MP1=M-1
      LP2=L
      MP2=M-1
      ASSIGN 260 TO KR1
      GO TO 280
260   IF (K2+K4.NE.1) GO TO 270
      IC1=2
      IC2=4
      LP1=L
      MP1=M-1
      LP2=L
      MP2=M
      ASSIGN 270 TO KR1
      GO TO 280
270   IF (K3+K4.NE.1) GO TO 520
      IC1=3
      IC2=4
      LP1=L-1
      MP1=M
      LP2=L
      MP2=M
      ASSIGN 520 TO KR1
280   LL=LL+1
      XX=(CON(KK)-CQ(LP1,MP1))/(CQ(LP2,MP2)-CQ(LP1,MP1))
      IF (LL.EQ.2) GO TO 290
      IX1=FIXL+(XCO(IC1)+XX*(XCO(IC2)-XCO(IC1))-XL)*XCONV
      IY1=FIYB+(YCO(IC1)+XX*(YCO(IC2)-YCO(IC1))-YB)*YCONV
      GO TO KR1,(250,260,270,320)
290   IX2=FIXL+(XCO(IC1)+XX*(XCO(IC2)-XCO(IC1))-XL)*XCONV
      IY2=FIYB+(YCO(IC1)+XX*(YCO(IC2)-YCO(IC1))-YB)*YCONV
      CALL DRV (IX1,IY1,IX2,IY2)
      IF (KK.NE.1) GO TO 300
      CALL PLT (IX1,IY1,35)
300   IF (KK.NE.K) GO TO 310
      CALL PLT (IX1,IY1,24)
310   LL=0
      IF (LP2.NE.L) GO TO 520
      IF (MP2.NE.M) GO TO 320
      GO TO 260
320   CONTINUE
      CONTINUE
520   CONTINUE

      DO 330 L=2,LMAX
      IX1=FIXL+(FLOAT(L-2)*DX)*XCONV
      IX2=FIXL+(FLOAT(L-1)*DX)*XCONV
      IY1=FIYB+(YCB(L-1)-YB)*YCONV
      IY2=FIYB+(YCB(L)-YB)*YCONV
      IY3=FIYB+(YW(L-1)-YB)*YCONV
      IY4=FIYB+(YW(L)-YB)*YCONV
      CALL DRV (IX1,IY1,IX2,IY2)
      CALL DRV (IX1,IY3,IX2,IY4)
330   CONTINUE
      GO TO 70

340   DY=1.0/FLOAT(MMAX-1)
      CALL ADV (1)
      RETURN

400   FORMAT (1H ,10HLOW VALUE=,1PE11.4,2X,11HHIGH VALUE=,E11.4,2X,
     1 12HLOW CONTOUR=,E11.4,2X,13HHIGH CONTOUR=,E11.4,2X,
     2 14HDELTA CONTOUR=,E11.4)
410   FORMAT (1H ,16HVELOCITY VECTORS)
550   FORMAT (1H ,A10,4X,8A10,2X,2HN=,I4,2X,2HT=,1PE10.4,4H SEC)
560   FORMAT (1H ,7HDENSITY)
570   FORMAT (1H ,8HPRESSURE)
580   FORMAT (1H ,11HTEMPERATURE)
590   FORMAT (1H ,11HMACH NUMBER)
      END
