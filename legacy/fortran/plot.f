
SUBROUTlNt PLOT(TITLE# Tf NP)

PLT
PLT
PLT
PLT
THIS SUBROUTINE PLOTS THE VELOCITY VECTORS AND DEPENDENT VARIABLE PLT
CONTOUR PLOTS
PLT
PLT
PLT
PLT
DIMENSION CQ(81,?J), CON(<), XCO(4), YCO(=) , TITLE(B)
PLT
COMMON /*V/ IAV,C*VfNST,SMP,L8S,CT*fXMU,XL* , RKMU ,GUT(81,21),OVT(81PLT
i,2n,aPT(Bt,?n
PLT
COMMON /ONESID/ UDC4),VD(4),PD(4),ROD(4)
PLT
COMMON /SOLUTN/ U(81,21,2),V(81,21,2),P(81, 21,2) ,R0(81,21,2)
PLT
COMMON /CNTRLC/ LMAX.MMAX,NMAX,NPRINT.TCONV ,fdt, GAMMA,RGAS,GAMt,GAPLT
1M2,LI,L2,L5,MI,M2,DX,DY,DT,N,NI,N3,NASM,IVEL,ICHAR,N1D,LJET,JFLAG , PLT
2IERR,IUI,IUO,DXR,DYR,LD,MD,LMDI,LHD3,IB,RSTAR,RSTARS,NPLOT,G,PC,TCPLT
PLT
3,LC,PLOH,ROLOM
COMMON /GEMTRYC/ NGEOM,XI,RI,XT,RT,XE,RE,RCI,RCT ,ANGI,ANGE,XW(B1) , PLT
PLT
1YM(81),XWI(81),YWI(81),NXNY(81),NMPTS,IINT, IDIF, LT.NDIM
COMMON /GCB/ NGCB,X1CB,RICB,XTCB.RTCB,XECB, RECB, RCICB,RCTCB,ANGICBPLT
1,ANGECB,XCB(01),YCB(B1),XCBI(S1),YCBI(B1),NXNYCB(S1),NCBPTS,iintcbplt
PLT
2,IDIFCB,LECB
COMMON /BCC/ PT(21),TT(21),THETA(2l),PE,MASSE,MASSI,MASST,THRUST, NPLT
PLT
ISTAG
REAL MN3,NXNY,MASS I,MASST,NXNYCB,MASSE
PLT
PLT
PLT
GENERATE THE VELOCITY VECTOR PLOT
PLT
PLT
NO=N3
IF (N,EG,0) ND* 1
PLT
PLT
CALL GETG (4LKJBN,JNM)
PLT
XL*XI
PLT
XR=XE
YT*YW(1)
PLT
PLT
YB*YCB(1)
PLT
DO 10 L*2,LMAX
PLT
YT*AMAX1(YT,YW(L))
PLT
YB*AMIN1(YB,YCB(L))
PLT
CONTINUE
PLT
VV*0,9*DX
PLT
FIYB916.0
PLT
XD=(XR-XL)/(YT-YB)
PLT
FIR*(l022,01022,0/FLOAT(Ll)l,0)/900,0
PLT
IF(XD.LE.FIR) GO TO 20
PLT
F1XL*0,0
PLT
FIXR*1022,0-1022,0/FLOAT(Ll)-1,0
PLT
FIYT*9I6,0-FIXR/XO
PLT
GO TO 30
PLT
FIXL=511,0-450,0XD
PLT
FIXR*511,0+450,0*XD
PLT
FIYT=16,0
PLT
XCONV*(FIXR.FIXL)/(XR-XL)
PLT
YC0NV*(FIYTF1YB)/(YT-YB)
PLT
VMAX*0,0
PLT
DO 40 L*1,LMAX
PLT
DO 40 M*1,MMAX
PLT
VMAX*AMAXl(VMAX,ABS(U(L,M,ND)),ABS(V(L,M,NO)))
PLT
continue
PLT
IF (VMAX.LT,1.0E-10) GO TO 60
PLT
DROU=VV/VMAX
PLT
CALL ADV (1)
PLT
DO 50 L*1,LMAX
PLT
IX1=FIXL*(FLOAT(L*l)*DX)*XCONV
DY=( YW(L)-YCB(D)/FLOAT (MMAX. 1)
PLT
PLT
DO 50 M*1,MMAX
PLT
IY1*FIY0+(YCB(L)+FLOAT(M.1)DY=YB)YCONV
PLT
IX2*FIXL+(FLOAT(L.l)=DX+U(L,M,ND)OROU)*XCONV
1Y2FIYB+{YCB(L)*FL0AT(M.1)0Y.YB+V(L,M,N0)=DR0U)*YC0NV
PLT
PLT
CALL DRV (IX1,IY1,IX2,IY2)
PLT
CALL PLT (IX1,IY1,16)
PLT
CONTINUE
PLT
CALL LINCNT (59)
PLT
WRITE (7,410)
PLT
WRITE (7S50)JNM,TITLE,NP,T
PLT
PLT
GENERATE THE CONTOUR PLOTS
PLT
PLT
1*0
PLT
1*1 + 1
PLT
GO TO (80,100,120,140,340), I
PLT
DO 90 L*l,LMAX
PLT
DO 90 M*1,MMAX
PLT
CO(L,M)*RO(L,M,NO)*G

10
20
30
40
50
60
70
80
90
100
110
120
130
140
150
160
170
1B0
190
200
210
220
230
240
250
260
270
280
290
300
310
320
330
340
350
360
370
380
390
400
410
420
430
440
450
460
470
480
490
500
510
520
530
540
550
560
570
580
590
600
610
620
630
640
650
660
670
680
690
700
710
720
730
740
750
760
770
780
790
600
610
820
830
840

65

'0
100
110
120
150
140

150
140

170

1 A0

1 90
200
210
220
250

240

250

260

270

66

CONTINUE
PLT
GO TO 160
PLT
DO 110 L* 1UNAX
PLT
DO 110 M1# MMAX
PLT
C9a#M)P(L,M,ND)/PC
PLT
CONTINUE
PLT
GO TO 160
PLT
DO 150 1*1,LMAX
PLT
DO |50 M*1,MMAX
PLT
PLT
CQ(L,M)*P(L,M,N0)/R0(L,M,ND)/RGA8/G.TC
CONTINUE
PLT
GO TO 160
PLT
DO 150 L*1,LMAX
PLT
DO 150 M*1,MMAX
PLT
CO(L,M)SORTf(U(L,M,N0)*2V(L,M, ND)**2)/(GAMMAP(L, M,ND)/RO(L,M,NPLT
ID)))
PLT
CONTINUE
PLT
QMN*1,0E06
PLT
QMXbvQMN
PLT
DO 170 L*1,LMAX
PLT
DO 170 M=1,MMAX
PLT
QMNsAMIN1(CQU,M),QMN)
PLT
GMXsAMAXI(CO(L,M),QMX)
PLT
CONTINUE
PLT
XX*QMX>QMN
PLT
08*0,t*XX
PLT
DO 100 K*!,9
PLT
CON(K)*8MN+(FLOAT(K))*D8
PLT
PLT
CONTINUE
K*9
PLT
CALL ADV tl)
PLT
PLT
CALL LINCNT (59)
GO TO (190,200,210,220), I
PLT
HRITE (7,560)
PLT
GO TO 250
PLT
WRITE (7,570)
PLT
GO TO 250
PLT
PLT
WRITE (7,100)
GO TO 250
PLT
WRITE (7,590)
PLT
WRITE (7,400)QMN,QMX,CON(1),CON(K),DG
PLT
WRITE (7,550)JNM,TITLE,NP,T
PLT
PLT
DO 520 L*2,LMAX
Dr=(VW(Ll)-VCB(L-l))/FLOAT(MMAX* 1)
PLT
PLT
Dri*(YN(L)-YC0(L))/FLOAT(MMAX-1)
DO 520 M*2,MMAX
PLT
PLT
NN0
PLT
DO 520 KK*|,K
K1=K2*K5*K4*0
PLT
PLT
IF (C8(L-1,M-1),LE,C0N(KK)) K1 *1
PLT
IF (CSCLtM-n.LE.CONIKK)) K2*I
IF (Ce(L-l,M)(LEaCON(KK)) K5*S
PLT
IF (Ca(L,M),LE,CON(KK)) K4*i
PLT
PLT
IF (Kt*K2*K5*K4lNE,0) GO TO 520
PLT
IF (K1+K2+K1+K4,EB,0) GO TO 520
PLT
IF (NN,NE,0) GO TO 240
PLT
nn=i
XC0(1)*XI*FL0AT(L*2)*DX
PLT
PLT
XCO(2)*XCO(1)*DX
PLT
XC0(5)*XCO(l)
PLT
XCO(4)*XCO(2)
PLT
YC0(1)*YCB(L1)?FLOAT(M.2)*0Y
PLT
YC0(2)*YCB(L)tFL0AT(M-2)0YJ
PLT
YCO(5)oYCB(L-I)AFLOAT(M.|)=DY
PLT
YCO(4)=YCB(L)tFLOAT(M.|)*0Yl
PLT
LL=0
PLT
IF (K1+K5,NE,1) GO TO 250
PLT
ICi1 t IC2*5 * LP1*L*1 * MP1*M*J S LR2wL1 1 MP2*M
PLT
ASSIGN 250 TO KR1
PLT
GO TO 200
PLT
IF (Kl+02tNE,l) GO TO 260
PLT
ICI*1 S IC2*2 1 LP1L-1 * MP1M*1 S LP2*L S MP2*M1
PLT
ASSIGN 260 TO KR1
PLT
CO TO 200
PLT
IF (K2+K4,NE,n GO TO 270
PLT
1C 1*2 * IC2=q S LP1*L S MP1*M1 I LP2*L * MP2*M
PLT
ASSIGN 270 TO KR1
PLT
GO TO 200
PLT
IF (K5+K4,NE,I> GO TO 520
PLT
MP2*M
IC1*5 * IC2*4 I LPI*L-1 1 MP J *M J LP2*L S
PLT
ASSIGN 520 TO KR1

B50
S60
870
660
690
900
910
920
950
940
950
960
970
900
990
1000
1010
1020
1050
1040
1050
1060
1070
1000
1090
1100
1110
1120
1150
1140
1150
1160
1170
1100
1190
1200
1210
1220
1250
1240
1250
1260
1270
1200
1290
1500
1510
1520
1550
1540
1550
1560
1570
1560
1590
1400
1410
1420
1450
1440
1450
1460
1470
1480
1490
1500
1510
1520
1550
1540
1550
1560
1570
1500
1590
1600
1610
1620
1650
1640
1650

?8fl

290

100
U0

520
C
C
C

530
540

C
550
360
370
380
390
400
4]0

U=LL*1
XX=(C0N(KK).CQ(LPJ,MPl))/(C0aP2,MP2)-C0(LP|,MPH)
IF (Lt.EQ,2) GO TO 290
IX1=FJXt+(XCOCICn*XX*(XCO(IC2I=XCO(ICn)"XL)*XCONV
lYIaFIYB*(yC0(ICn*XX*(YC0(IC2)=VC0(ICn)=YB)*YC0NV
GO TO KR1,(250,260,270,320)
1X2FIXL*(XC0(IC1)*XX(XC0(IC2)',XC0(IC1) ) XL ) XCONV
1Y2=FIYB+(YC0(IC1)*XX*(YC0(IC2)*YC0(IC)))-YB)YC0NV
CALL DRV (IXI,IYI,IX2,IY2)
IF (KK.NE.l) 80 TO 300
CALL PIT CIX!,IY!,35>
IF (KK.NE.K) GO TO 310
CALI PLT (IX1,IY1,24)
LL=0
IF (LP0.NE.L1 GO TO 520
IF (MPP.NE.M.n GO TO 320
GO TO 260
CONTINUE

PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
PLT
DRAW THE GEOMETRY CONTOURS
PLT
PLT
DO 330 L2,LMAX
PLT
1X1?FIXLA(FLOAT(L-2)DX)=XC0NV
PLT
IX2=FIXL+(FL0AT(L"1)*DX)XC0NV
PLT
1Y1=FIYB*(YCB(L=1)*YB)*YC0NV
PLT
IY2=FIYB+(YCB(L)YB)YC0NV
PLT
lY3FIYBt(YH(L*nYB)YCONV
PLT
IY4FIYB+(YH(L)*VB)=YC0NV
PLT
CALL DRV (IX!,IY1,IX2,IY2)
PLT
CALL DRV (IX1,IY3,IX2,IY4)
PLT
CONTINUE
PLT
GO TO 70
PLT
CONTINUE
PLT
OY=1,0/FLOAT(MMAX1)
PLT
PLT
CALL ADV (1)
PLT
RETURN
PLT
FORMAT (IH ,A10,4X,8A10,2X,2HN=,I4,2X,2HTa,1PE10,4,4H SEC)
PLT
PLT
FORMAT (IH ,7HDENSITY)
PLT
FORMAT (IH ,BHPRE8SURE)
PLT
FORMAT (IH ,11HTEMPERATURE)
PLT
FORMAT (IH ,|1HMACH NUMBER)
12HL0PLT
FORMAT (IH ,10HLOW VALUE*,IPEll,4,2X,I1HHIGH VALUE*,E11,4,2X,
|N CONTOUR*,Ell,4,2X,13HHIGH CONTOUR*,E11,4,2X,I4HDELTA CONTOUR*,E|PLT
PLT
21,4)
PLT
FORMAT (IH ,|6HVEL0CITV VECTORS)
END
