      SUBROUTINE EXITT
C
C     **************************************************************
C     THIS SUBROUTINE CALCULATES THE BOUNDARY MESH POINTS AT THE
C     NOZZLE EXIT FOR SUBSONIC FLOW
C     **************************************************************
C
C     OCR note:
C     This file was reconstructed from Appendix C PDF text blocks.
C     Compatibility-equation updates were line-aligned to Appendix C
C     degraded text blocks and normalized to fixed-form syntax.
C
      COMMON /AV/ IAV,CAV,NST,SMP,LSS,CTA,XMU,XLA,RKMU,QUT(81,21),QVT(81,21),QPT(81,21)
      COMMON /ONESID/ UD(4),VD(4),PD(4),ROD(4)
      COMMON /SOLUTN/ U(81,21,2),V(81,21,2),P(81,21,2),RO(81,21,2)
      COMMON /CNTRLC/ LMAX,MMAX,NMAX,NPRINT,TCONV,FDT,GAMMA,RGAS,GAM1,GAM2,
     1L1,L2,L3,M1,M2,DX,DY,DT,N,N1,N3,NASM,IVEL,ICHAR,N1D,LJET,JFLAG,
     2IERR,IUI,IUO,DXR,DYR,LD,MD,LMD1,LMD3,IB,RSTAR,RSTARS,NPLOT,G,PC,TC,
     3LC,PLOW,ROLOW
      COMMON /GEMTRYC/ NGEOM,XI,RI,XT,RT,XE,RE,RCI,RCT,ANGI,ANGE,XW(81),
     1YW(81),XWI(81),YWI(81),NXNY(81),NWPTS,IINT,IDIF,LT,NDIM
      COMMON /GCB/ NGCB,XICB,RICB,XTCB,RTCB,XECB,RECB,RCICB,RCTCB,ANGICB,
     1ANGECB,XCB(81),YCB(81),XCBI(81),YCBI(81),NXNYCB(81),NCBPTS,IINTCB,
     2IDIFCB,LECB
      COMMON /BCC/ PT(21),TT(21),THETA(21),PE,MASSE,MASSI,MASST,THRUST,
     1NSTAG
      REAL MN3,NXNY,MASSI,MASST,NXNYCB,MASSE
C
      X3=XE
      ATERM1=0.0
      ATERM2=0.0
      ATERM3=0.0
C
      DO 160 ICHAR=1,2
      DO 160 M=1,MMAX
      CALL MAP (2,LMAX,M,AL,BE,DE,L1,AL1,BE1,DE1)
      U1=U(LMAX,M,N1)
      U2=U1
      A1=SQRT(GAMMA*P(LMAX,M,N1)/RO(LMAX,M,N1))
      A2=A1
      IF (ICHAR.EQ.2) GO TO 10
      U(LMAX,M,N3)=U1
      A3=A1
C
C     CALCULATE THE PROPERTY INTERPOLATING POLYNOMIAL COEFFICIENTS
C
10    BU=(U(LMAX,M,N1)-U(L1,M,N1))*DXR
      BV=(V(LMAX,M,N1)-V(L1,M,N1))*DXR
      BP=(P(LMAX,M,N1)-P(L1,M,N1))*DXR
      BRO=(RO(LMAX,M,N1)-RO(L1,M,N1))*DXR
      BYCB=(YCB(LMAX)-YCB(L1))*DXR
      BAL=(AL-AL1)*DXR
      BBE=(BE-BE1)*DXR
      BDE=(DE-DE1)*DXR
      CU=U(LMAX,M,N1)-BU*X3
      CV=V(LMAX,M,N1)-BV*X3
      CP=P(LMAX,M,N1)-BP*X3
      CRO=RO(LMAX,M,N1)-BRO*X3
      CYCB=YCB(LMAX)-BYCB*X3
      CAL=AL-BAL*X3
      CBE=BE-BBE*X3
      CDE=DE-BDE*X3
C
C     CALCULATE THE CROSS DERIVATIVE INTERPOLATING POLYNOMIAL
C     COEFFICIENTS
C
      IF (M.EQ.1) GO TO 20
      DU=(U(LMAX,M,N1)-U(LMAX,M-1,N1))*DYR
      DV=(V(LMAX,M,N1)-V(LMAX,M-1,N1))*DYR
      DP=(P(LMAX,M,N1)-P(LMAX,M-1,N1))*DYR
      DRO=(RO(LMAX,M,N1)-RO(LMAX,M-1,N1))*DYR
      DU1=(U(L1,M,N1)-U(L1,M-1,N1))*DYR
      DV1=(V(L1,M,N1)-V(L1,M-1,N1))*DYR
      DP1=(P(L1,M,N1)-P(L1,M-1,N1))*DYR
      DRO1=(RO(L1,M,N1)-RO(L1,M-1,N1))*DYR
      GO TO 80
20    IF (LECB.EQ.LMAX) GO TO 30
      DU=0.0
      DV=V(LMAX,2,N1)*DYR
      DP=0.0
      DRO=0.0
      DU1=0.0
      DV1=V(L1,2,N1)*DYR
      DP1=0.0
      DRO1=0.0
      GO TO 80
30    DU=(U(LMAX,2,N1)-U(LMAX,1,N1))*DYR
      DV=(V(LMAX,2,N1)-V(LMAX,1,N1))*DYR
      DP=(P(LMAX,2,N1)-P(LMAX,1,N1))*DYR
      DRO=(RO(LMAX,2,N1)-RO(LMAX,1,N1))*DYR
      DU1=(U(L1,2,N1)-U(L1,1,N1))*DYR
      DV1=(V(L1,2,N1)-V(L1,1,N1))*DYR
      DP1=(P(L1,2,N1)-P(L1,1,N1))*DYR
      DRO1=(RO(L1,2,N1)-RO(L1,1,N1))*DYR
80    BDU=(DU-DU1)*DXR
      BDV=(DV-DV1)*DXR
      BDP=(DP-DP1)*DXR
      BDRO=(DRO-DRO1)*DXR
      CDU=DU-BDU*X3
      CDV=DV-BDV*X3
      CDP=DP-BDP*X3
      CDRO=DRO-BDRO*X3
C
C     CALCULATE X1 AND X2
C
      IF (ICHAR.EQ.2) A3=SQRT(GAMMA*P(LMAX,M,N3)/RO(LMAX,M,N3))
      DO 50 IL=1,2
      X1=X3-(U(LMAX,M,N3)-U1)*0.5*DT
      X2=X3-(U(LMAX,M,N3)-A3+U2-A2)*0.5*DT
C
C     INTERPOLATE FOR THE PROPERTIES
C
      U1=BU*X1+CU
      U2=BU*X2+CU
      P2=BP*X2+CP
      RO2=BRO*X2+CRO
      A2=SQRT(GAMMA*P2/RO2)
50    CONTINUE
      V1=BV*X1+CV
      P1=BP*X1+CP
      RO1=BRO*X1+CRO
      YCB1=BYCB*X1+CYCB
      AL1=BAL*X1+CAL
      BE1=BBE*X1+CBE
      DE1=BDE*X1+CDE
      UV1=U1*AL1+V1*BE1+DE1
      A1=SQRT(GAMMA*P1/RO1)
      V2=BV*X2+CV
      YCB2=BYCB*X2+CYCB
      AL2=BAL*X2+CAL
      BE2=BBE*X2+CBE
      DE2=BDE*X2+CDE
      UV2=U2*AL2+V2*BE2+DE2
C
C     INTERPOLATE FOR THE CROSS DERIVATIVES
C
      DU1=BDU*X1+CDU
      DV1=BDV*X1+CDV
      DP1=BDP*X1+CDP
      DRO1=BDRO*X1+CDRO
      DU2=BDU*X2+CDU
      DV2=BDV*X2+CDV
      DP2=BDP*X2+CDP
      DRO2=BDRO*X2+CDRO
C
C     CALCULATE THE PSI TERMS
C
      IF (NDIM.EQ.0) GO TO 70
      IF (M.EQ.1.AND.LECB.NE.LMAX) GO TO 60
      ATERM1=RO1*V1/((DY*(M-1))/BE1+YCB1)
      ATERM2=RO2*V2/((DY*(M-1))/BE2+YCB2)
      GO TO 70
60    ATERM1=RO1*BE1*DV1
      ATERM2=RO2*BE2*DV2
70    PSI31=-UV1*DV1-BE1*DP1/RO1
      PSI41=-UV1*DP1+A1*A1*UV1*DRO1
      PSI12=-UV2*DRO2-RO2*AL2*DU2-RO2*BE2*DV2-ATERM2
      PSI22=-UV2*DU2-AL2*DP2/RO2
      PSI42=-UV2*DP2+A2*A2*UV2*DRO2
      IF (ICHAR.EQ.1) GO TO 130
C
C     CALCULATE THE CROSS DERIVATIVES AT THE SOLUTION POINT
C
      IF (M.EQ.1.AND.LECB.NE.LMAX) GO TO 88
      IF (M.EQ.MMAX) GO TO 98
      DU3=(U(LMAX,M+1,N3)-U(LMAX,M,N3))*DYR
      DV3=(V(LMAX,M+1,N3)-V(LMAX,M,N3))*DYR
      DP3=(P(LMAX,M+1,N3)-P(LMAX,M,N3))*DYR
      DRO3=(RO(LMAX,M+1,N3)-RO(LMAX,M,N3))*DYR
      GO TO 100
88    DU3=0.0
      DV3=V(LMAX,2,N3)*DYR
      DP3=0.0
      DRO3=0.0
      GO TO 100
98    DU3=(U(LMAX,MMAX,N3)-U(LMAX,M1,N3))*DYR
      DV3=(V(LMAX,MMAX,N3)-V(LMAX,M1,N3))*DYR
      DP3=(P(LMAX,MMAX,N3)-P(LMAX,M1,N3))*DYR
      DRO3=(RO(LMAX,MMAX,N3)-RO(LMAX,M1,N3))*DYR
C
C     CALCULATE THE PSI TERMS AT THE SOLUTION POINT
C
100   IF (NDIM.EQ.0) GO TO 120
      IF (M.EQ.1.AND.LECB.NE.LMAX) GO TO 110
      ATERM3=RO(LMAX,M,N3)*V(LMAX,M,N3)/((DY*(M-1))/BE+YCB(LMAX))
      GO TO 120
110   ATERM3=RO(LMAX,1,N3)*BE*DV3
120   UV3=U(LMAX,M,N3)*AL+V(LMAX,M,N3)*BE+DE
      PSI13=-UV3*DRO3-RO(LMAX,M,N3)*(AL*DU3+BE*DV3)-ATERM3
      PSI23=-UV3*DU3-AL*DP3/RO(LMAX,M,N3)
      PSI33=-UV3*DV3-BE*DP3/RO(LMAX,M,N3)
      PSI43=-UV3*DP3+A3*A3*UV3*DRO3
C
C     CALCULATE THE COMPATIBILITY EQUATION COEFFICIENTS
C
130   IF (ICHAR.EQ.1) GO TO 140
      PSI31B=(PSI31+PSI33)*0.5
      PSI41B=(PSI41+PSI43)*0.5
      PSI12B=(PSI12+PSI13)*0.5
      PSI22B=(PSI22+PSI23)*0.5
      PSI42B=(PSI42+PSI43)*0.5
      GO TO 150
140   PSI31B=PSI31
      PSI41B=PSI41
      PSI12B=PSI12
      PSI22B=PSI22
      PSI42B=PSI42
C
C     SOLVE THE COMPATIBILITY EQUATIONS FOR U, V, P, AND RO
C
150   P(LMAX,M,N3)=PE
      RO(LMAX,M,N3)=RO1+(P(LMAX,M,N3)-P1-DT*PSI41B)/(A3*A3+A1*A1)
      U(LMAX,M,N3)=U2+(((PSI42B+(RO2-RO(LMAX,M,N3))*(A2+A3)*PSI22B/4.0
     1 -(A2*A2+A3*A3)*PSI12B/2.0)*DT-(P(LMAX,M,N3)-P2))
     2 /(RO2+RO(LMAX,M,N3))/(A2+A3))*4.0
      V(LMAX,M,N3)=V1+DT*PSI31B
160   CONTINUE
C
      V(LMAX,MMAX,N3)=-U(LMAX,MMAX,N3)*NXNY(LMAX)
      V(LMAX,1,N3)=-U(LMAX,1,N3)*NXNYCB(LMAX)
      IF (JFLAG.EQ.0) RETURN
      V(LMAX,MMAX,N3)=V(LMAX,MMAX,N3)+XWI(LMAX)
      RETURN
      END
